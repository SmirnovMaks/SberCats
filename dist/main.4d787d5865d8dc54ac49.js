(()=>{"use strict";const e=({timing:e,draw:t,duration:a})=>{let s=performance.now();requestAnimationFrame((function i(l){let o=(l-s)/a;o>1&&(o=1);let c=e(o);t(c),o<1&&requestAnimationFrame(i)}))},t=new class{constructor(e){this.url=e}async getCats(){return(await fetch(`${this.url}/show`)).json()}updateCat(e,t){fetch(`${this.url}/update/${t}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}})}async getCatById(e){const t=await fetch(`${this.url}/show/${e}`);return console.log(2),t.json()}deleteCat(e){fetch(`${this.url}/delete/${e}`,{method:"DELETE"})}}("https://sb-cats.herokuapp.com/api/2/SmirnovMaks");class a{constructor(e,t,a,s,i,l,o){this.id=e,this.name=t,this.age=a,this.favourite=s,this.img_link=i,this.description=l,this.rate=o}renderCatCard(){document.querySelector(".cats__load").innerHTML="",document.querySelector(".cats__add").style.display="block";const e=document.createElement("li");e.id=this.id,e.className=`cat_${this.id}`,e.innerHTML=`<li class="cats__item"><div class="cats__photo"></div><div class="cats__desc"><h3 class="cats__name">${this.name}   </h3><div class="cats__rate"></div></div></li>`,document.querySelector(".cats__list").append(e),this.img_link&&(e.querySelector(".cats__photo").style.backgroundImage=`url(${this.img_link})`);for(let t=0;t<10;t++){let a=document.createElement("i");t<this.rate?a.className="fa-solid fa-star":a.className="fa-regular fa-star",e.querySelector(".cats__rate").append(a)}}renderCatModal(){const e=document.createElement("div");e.className=`cat__modal cat__modal-${this.id}`,e.style.display="none";let t="";t=this.favourite?'<i class="fa-solid fa-heart"></i>':'<i class="fa-regular fa-heart"></i>';let a=this.img_link;this.img_link||(a="../images/baseCat.png"),e.innerHTML=`<div class="cat__modal-wrapper"><div class="modal__close"><i class="fa-solid fa-xmark"></i>\n                </div><div class="cat__modal-photo"><img src="${a}" alt="Cat"></div><div class="cat__modal-info"><h2 class="cat__modal-name">${this.name}</h2><div class="cat__modal-like">${t}</div><div class="cat__modal-description">${this.description}</div><button class="cat__modal-update">Изменить</button><button class="cat__modal-delete">Удалить</button></div></div>`,document.body.append(e)}updateLike(){const e=document.querySelector(`.cat__modal-${this.id}`);e.querySelector(".cat__modal-like").addEventListener("click",(()=>{let a={favourite:!0};"fa-regular fa-heart"==e.querySelector(".cat__modal-like i").className?(e.querySelector(".cat__modal-like i").className="fa-solid fa-heart",a.favourite=!0):"fa-solid fa-heart"==e.querySelector(".cat__modal-like i").className&&(e.querySelector(".cat__modal-like i").className="fa-regular fa-heart",a.favourite=!1),t.updateCat(a,this.id)}))}addListeners(){const a=document.querySelector(`.cat_${this.id}`),s=document.querySelector(`.cat__modal-${this.id}`);a.addEventListener("click",(()=>{s.style.display="block",e({duration:300,timing:e=>e,draw(e){s.querySelector(".cat__modal-wrapper").style.opacity=e}})})),s.addEventListener("click",(e=>{e.target==s.querySelector(".cat__modal-delete")?(s.style.display="none",a.remove(),s.remove(),t.deleteCat(this.id),a.removeEventListener(),s.removeEventListener()):e.target.closest(".modal__close")?s.style.display="none":e.target.closest(".cat__modal-update")?console.log(2):e.target.closest(".cat__modal-wrapper")?e.target.closest(".cat__modal-like"):s.style.display="none"}))}init(){this.renderCatCard(),this.renderCatModal(),this.addListeners(),this.updateLike()}}(()=>{const t=document.querySelector(".cats__add"),a=document.querySelector(".modal"),s=document.querySelector(".modal__close");a.addEventListener("click",(e=>{e.target.closest(".modal__inner")||(a.style.display="none")})),s.addEventListener("click",(()=>{a.style.display="none"})),t.addEventListener("click",(t=>{a.style.display="block",e({duration:300,timing:e=>e,draw(e){a.style.opacity=e}})}))})(),document.querySelector(".add__cat").addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector(".modal"),a=t.querySelector(".inputName"),s=t.querySelector(".inputPhoto"),i=t.querySelector(".inputDesc"),l=t.querySelector(".inputAge");let o={id:Math.ceil(100*Math.random()+100),favourite:!1,rate:1};a.value&&s.value&&i.value&&l.value&&(o.name=a.value,o.img_link=s.value,o.description=i.value,o.age=+l.value,fetch("https://sb-cats.herokuapp.com/api/2/SmirnovMaks/add",{method:"POST",body:JSON.stringify(o),headers:{"Content-type":"application/json; charset=UTF-8"}}),t.style.display="none")})),t.getCats().then((e=>{(e=e.data).forEach((e=>{new a(e.id,e.name,e.age,e.favourite,e.img_link,e.description,e.rate).init()}))}))})();