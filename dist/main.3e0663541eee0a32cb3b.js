(()=>{"use strict";const t=({timing:t,draw:e,duration:a})=>{let i=performance.now();requestAnimationFrame((function s(l){let r=(l-i)/a;r>1&&(r=1);let c=t(r);e(c),r<1&&requestAnimationFrame(s)}))},e=new class{constructor(t,e){this.url=t}async getCats(){return(await fetch(`${this.url}/show`)).json()}updateCat(t,e){fetch(`${this.url}/update/${e}`,{method:"PUT",body:JSON.stringify(t),headers:{"Content-type":"application/json; charset=UTF-8"}})}addCat(t){fetch("https://sb-cats.herokuapp.com/api/2/SmirnovMaks/add",{method:"POST",body:JSON.stringify(t),headers:{"Content-type":"application/json; charset=UTF-8"}})}async getCatById(t){const e=await fetch(`${this.url}/show/${t}`);return console.log(2),e.json()}deleteCat(t){fetch(`${this.url}/delete/${t}`,{method:"DELETE"})}}("https://sb-cats.herokuapp.com/api/2/SmirnovMaks");class a{constructor(t,e,a,i,s,l,r){this.id=t,this.name=e,this.age=a,this.favourite=i,this.img_link=s,this.description=l,this.rate=r,this.init()}renderCatModal(){const t=document.createElement("div");t.className=`cat__modal cat__modal-${this.id}`,t.style.display="none";let e="";e=this.favourite?'<i class="fa-solid fa-heart"></i>':'<i class="fa-regular fa-heart"></i>';let a="";a=this.img_link?`<img src="${this.img_link}" alt="Cat"></img>`:"<div class='base__img'></div>",t.innerHTML=`<div class="cat__modal-wrapper"><div class="modal__close"><i class="fa-solid fa-xmark"></i>\n                </div><div class="cat__modal-photo">${a}</div><div class="cat__modal-info"><h2 class="cat__modal-name">${this.name}</h2><p class='cat__modal-age'>${this.age} y.o.</p></p><div class="cat__modal-like">${e}</div><div class="cat__modal-description">${this.description}</div><div class="cat__modal-buttons"><div class="cat__modal-btn"><i class="cat__modal-btn fa-solid fa-pen-to-square"></i></div><div class="cat__modal-btn"><i class="cat__modal-delete fa-solid fa-trash"></i></div></div></div></div>`,document.body.append(t)}updateLike(){const t=document.querySelector(`.cat__modal-${this.id}`);t.querySelector(".cat__modal-like").addEventListener("click",(()=>{let a={favourite:!0};"fa-regular fa-heart"==t.querySelector(".cat__modal-like i").className?(t.querySelector(".cat__modal-like i").className="fa-solid fa-heart",a.favourite=!0):"fa-solid fa-heart"==t.querySelector(".cat__modal-like i").className&&(t.querySelector(".cat__modal-like i").className="fa-regular fa-heart",a.favourite=!1),e.updateCat(a,this.id)}))}addListener(){const t=document.querySelector(`.cat_${this.id}`),a=document.querySelector(`.cat__modal-${this.id}`);a.addEventListener("click",(i=>{i.target==a.querySelector(".cat__modal-delete")?(a.style.display="none",document.querySelector("main").style.filter="",t.remove(),a.remove(),e.deleteCat(this.id)):i.target.closest(".modal__close")?(a.style.display="none",document.querySelector("main").style.filter=""):i.target.closest(".cat__modal-update")?console.log(2):i.target.closest(".cat__modal-wrapper")?i.target.closest(".cat__modal-like"):(a.style.display="none",document.querySelector("main").style.filter="")}))}init(){this.renderCatModal(),this.updateLike(),this.addListener()}}class i{constructor(t,e,a,i,s,l,r){this.id=t,this.name=e,this.age=a,this.favourite=i,this.img_link=s,this.description=l,this.rate=r,this.init()}renderCatCard(){document.querySelector(".cats__load").innerHTML="",document.querySelector(".cats__add").style.display="block";const t=document.createElement("li");t.id=this.id,t.className=`cat_${this.id}`,t.innerHTML=`<li class="cats__item"><div class="cats__photo"></div><div class="cats__desc"><h3 class="cats__name">${this.name}   </h3><div class='cats__rate-wrapper'><div class='minus'><i class="fa-solid fa-minus"></i></div><div class="cats__rate"></div><div class='plus'><i class="fa-solid fa-plus"></i></div></div></div></li>`,document.querySelector(".cats__list").append(t),this.img_link&&(t.querySelector(".cats__photo").style.backgroundImage=`url(${this.img_link})`),this.calculateRateAndShowOnHTML(this.rate),new a(this.id,this.name,this.age,this.favourite,this.img_link,this.description,this.rate)}calculateRateAndShowOnHTML(t){const e=document.querySelector(`.cat_${this.id}`).querySelector(".cats__rate");e.innerHTML="";for(let a=0;a<10;a++){let i=document.createElement("i");i.className=a<t?"fa-solid fa-star":"fa-regular fa-star",e.append(i)}}addListeners(){const a=document.querySelector(`.cat_${this.id}`),i=document.querySelector(`.cat__modal-${this.id}`),s=()=>{if(null!==this.rate&&this.rate&&!isNaN(this.rate)||(this.rate=0),10!=this.rate){this.rate++,this.calculateRateAndShowOnHTML(this.rate);let t={rate:this.rate};e.updateCat(t,this.id)}},l=()=>{if(1!=this.rate){this.rate--,this.calculateRateAndShowOnHTML(this.rate);let t={rate:this.rate};e.updateCat(t,this.id)}};a.addEventListener("click",(e=>{e.target.closest(".plus")?s():e.target.closest(".minus")?l():(console.log(this.rate),i.style.display="block",document.querySelector("main").style.filter="blur(3px)",t({duration:500,timing:t=>t,draw(t){i.querySelector(".cat__modal-wrapper").style.opacity=t}}))}))}init(){this.renderCatCard(),this.addListeners()}}(()=>{const e=document.querySelector(".cats__add"),a=document.querySelector(".modal"),i=document.querySelector(".modal__close");a.addEventListener("click",(t=>{t.target.closest(".modal__inner")||(a.style.display="none",document.querySelector("main").style.filter="")})),i.addEventListener("click",(()=>{a.style.display="none",document.querySelector("main").style.filter=""})),e.addEventListener("click",(e=>{a.style.display="flex",document.querySelector("main").style.filter="blur(3px)",t({duration:300,timing:t=>t,draw(t){a.style.opacity=t}})}))})(),document.querySelector(".add__cat").addEventListener("submit",(t=>{t.preventDefault();const a=document.querySelector(".modal"),s=a.querySelector(".inputName"),l=a.querySelector(".inputPhoto"),r=a.querySelector(".inputDesc"),c=a.querySelector(".inputAge");let d={id:Math.ceil(100*Math.random()+100),favourite:!1,rate:1};d.name=s.value,d.img_link=l.value,d.description=r.value,d.age=+c.value,e.addCat(d),new i(d.id,d.name,d.age,d.favourite,d.img_link,d.description,d.rate).init(),a.style.display="none"})),e.getCats().then((t=>{(t=t.data).forEach((t=>{new i(t.id,t.name,t.age,t.favourite,t.img_link,t.description,t.rate)}))}))})();